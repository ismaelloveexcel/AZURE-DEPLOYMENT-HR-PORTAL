{
  "application": {
    "name": "Baynunah HR Portal",
    "type": "Internal HR Management System",
    "purpose": "Self-service employee onboarding, contract renewals, compliance tracking, and recruitment management for UAE-based organizations",
    "entities_supported": [
      "Baynunah Watergeneration Technologies SP LLC",
      "Baynunah Agriculture LLC"
    ]
  },

  "technology_stack": {
    "frontend": {
      "framework": "React 19 with TypeScript",
      "build_tool": "Vite",
      "styling": "TailwindCSS v4",
      "port": 5000,
      "architecture": "Single Page Application (SPA)"
    },
    "backend": {
      "framework": "FastAPI (Python)",
      "server": "Uvicorn ASGI",
      "port": 5001,
      "architecture": "Layered (Routers → Services → Repositories)"
    },
    "database": {
      "type": "PostgreSQL",
      "driver": "asyncpg (async)",
      "orm": "SQLAlchemy",
      "migrations": "Alembic"
    }
  },

  "authentication": {
    "method": "JWT (JSON Web Tokens)",
    "login_credentials": {
      "username": "Employee ID (e.g., ADMIN001, EMP001)",
      "password": "Initial password is DOB in DDMMYYYY format",
      "first_login": "Forces password change on first login"
    },
    "roles": [
      {
        "role": "admin",
        "permissions": "Full system access, manage employees, view all data, recruitment management"
      },
      {
        "role": "hr",
        "permissions": "Manage employees, compliance, recruitment, approve changes"
      },
      {
        "role": "viewer",
        "permissions": "Read-only access to dashboards and reports"
      },
      {
        "role": "employee",
        "permissions": "Self-service profile, document uploads, view own data"
      }
    ]
  },

  "database_schema": {
    "core_tables": {
      "employees": {
        "description": "Main employee records with authentication",
        "key_fields": ["employee_id (PK)", "full_name", "email", "role", "job_title", "department", "line_manager", "salary", "leave_entitlement", "probation_dates"],
        "record_count": 76
      },
      "employee_profiles": {
        "description": "Extended self-service profile data",
        "key_fields": ["employee_id (FK)", "emergency_contact", "bank_details", "address", "personal_info"],
        "linked_to": "employees.employee_id"
      },
      "employee_compliance": {
        "description": "Visa, work permit, medical fitness tracking",
        "key_fields": ["employee_id (FK)", "document_type", "expiry_date", "status"],
        "linked_to": "employees.employee_id"
      },
      "employee_bank": {
        "description": "Bank details with approval workflow",
        "key_fields": ["employee_id (FK)", "bank_name", "account_number", "iban", "pending_changes", "verified_by", "verified_at"],
        "linked_to": "employees.employee_id"
      },
      "employee_documents": {
        "description": "Document registry with OCR support",
        "key_fields": ["employee_id (FK)", "document_type", "file_path", "ocr_data", "expiry_date", "verification_status"],
        "linked_to": "employees.employee_id"
      }
    },
    "operational_tables": {
      "renewals": {
        "description": "Contract renewal tracking with approval workflow",
        "key_fields": ["employee_id", "renewal_type", "current_end_date", "proposed_end_date", "status", "approver_id"]
      },
      "passes": {
        "description": "Access passes for recruitment/onboarding",
        "key_fields": ["pass_number", "pass_type", "holder_name", "valid_from", "valid_until", "status"]
      },
      "onboarding_tokens": {
        "description": "Secure single-use invite tokens for new joiners",
        "key_fields": ["token", "employee_id", "expires_at", "used_at"],
        "expiry": "7 days"
      },
      "system_settings": {
        "description": "Feature toggles and admin configuration",
        "key_fields": ["setting_key", "setting_value", "description"]
      }
    },
    "recruitment_tables": {
      "recruitment_requests": {
        "description": "Job requisitions/positions to fill",
        "key_fields": ["request_number", "position_title", "department", "employment_type", "salary_range", "hiring_manager_id", "status"],
        "numbering": "REQ-YYYYMMDD-XXXX"
      },
      "candidates": {
        "description": "Candidate profiles linked to positions",
        "key_fields": ["candidate_number", "recruitment_request_id", "full_name", "email", "entity", "stage", "status"],
        "numbering": "CAN-YYYYMMDD-XXXX"
      },
      "recruitment_passes": {
        "description": "Access passes for candidates",
        "key_fields": ["pass_number", "candidate_id", "valid_from", "valid_until", "status"],
        "numbering": "REC-YYYYMMDD-XXXX"
      }
    }
  },

  "modules": {
    "admin_section": {
      "description": "Central HR management hub with four-tab navigation",
      "tabs": [
        {
          "name": "Dashboard",
          "features": ["Quick stats", "Recent activity", "Pending approvals", "Compliance alerts summary"]
        },
        {
          "name": "Employees",
          "features": ["Employee list with search/filter", "View/edit employee profiles", "Bulk CSV import", "Add new employees"]
        },
        {
          "name": "Compliance Alerts",
          "features": ["Color-coded urgency indicators", "Document expiry tracking", "Quick actions", "View profile links"],
          "urgency_colors": {
            "red": "Expired",
            "orange": "Expires within 7 days",
            "yellow": "Expires within 30 days",
            "amber": "Expires within 60 days"
          }
        },
        {
          "name": "Recruitment",
          "features": ["Job positions list", "Candidate pipeline", "Stage management", "Pass generation"]
        }
      ]
    },

    "recruitment_module": {
      "description": "Multi-entity recruitment management",
      "entities": {
        "Baynunah Watergeneration Technologies SP LLC": {
          "header_color": "#00B0F0",
          "color_name": "Blue"
        },
        "Baynunah Agriculture LLC": {
          "header_color": "#92D050",
          "color_name": "Green"
        }
      },
      "candidate_stages": ["applied", "screening", "assessment", "interview", "offer", "hired", "rejected"],
      "candidate_profile_sections": {
        "visible_to_all": [
          {
            "section": "CV / Resume",
            "fields": ["resume_path", "linkedin_url"]
          },
          {
            "section": "Availability & Expectations",
            "fields": ["notice_period_days", "availability_date", "expected_salary", "salary_negotiable"]
          },
          {
            "section": "Work Eligibility",
            "fields": ["current_location", "current_country", "visa_status", "willing_to_relocate", "has_driving_license"]
          },
          {
            "section": "References",
            "fields": ["references (name, relationship, company, email, phone)"],
            "disclaimer": "References will only be contacted if candidate is finalised for the position"
          }
        ],
        "visible_to_hr_admin_only": [
          {
            "section": "Soft Skills Evaluation",
            "skills": ["Communication", "Teamwork", "Problem Solving", "Leadership", "Adaptability", "Time Management"],
            "rating_scale": "1-5 points"
          },
          {
            "section": "Technical Skills Evaluation",
            "skills": ["Domain Knowledge", "Technical Proficiency", "Analytical Thinking", "Tool Expertise", "Industry Experience", "Quality of Work"],
            "rating_scale": "1-5 points"
          },
          {
            "section": "Internal Notes",
            "fields": ["recruiter_notes", "interview_observations"]
          }
        ]
      }
    },

    "self_service_onboarding": {
      "description": "Employee-facing profile management",
      "features": [
        "Profile completion with progress tracking",
        "Personal information updates",
        "Bank details submission (requires HR approval)",
        "Document uploads with OCR auto-extraction",
        "Emergency contact management"
      ],
      "document_types_supported": [
        "passport", "visa", "emirates_id", "work_permit",
        "medical_fitness", "contract", "educational",
        "training", "security_clearance"
      ],
      "ocr_patterns": {
        "emirates_id": "784-XXXX-XXXXXXX-X format detection"
      }
    },

    "compliance_tracking": {
      "description": "Document expiry and regulatory compliance",
      "tracked_documents": ["Visa", "Work Permit", "Emirates ID", "Medical Fitness", "Passport"],
      "alert_thresholds": {
        "critical": "Expired or expires today",
        "urgent": "Expires within 7 days",
        "warning": "Expires within 30 days",
        "notice": "Expires within 60 days"
      }
    }
  },

  "api_structure": {
    "base_url": "/api",
    "auth_endpoints": {
      "POST /auth/login": "Authenticate with employee_id and password",
      "POST /auth/logout": "Invalidate current session",
      "GET /auth/me": "Get current authenticated user"
    },
    "employee_endpoints": {
      "GET /employees": "List all employees (paginated, filterable)",
      "GET /employees/{id}": "Get single employee details",
      "POST /employees": "Create new employee",
      "PUT /employees/{id}": "Update employee",
      "DELETE /employees/{id}": "Soft delete employee"
    },
    "recruitment_endpoints": {
      "GET /recruitment/requests": "List job requisitions",
      "POST /recruitment/requests": "Create job requisition",
      "GET /recruitment/requests/{id}": "Get requisition details",
      "GET /recruitment/candidates": "List candidates (filterable by position)",
      "POST /recruitment/candidates": "Create candidate",
      "PUT /recruitment/candidates/{id}": "Update candidate",
      "PUT /recruitment/candidates/{id}/stage": "Move candidate to next stage",
      "GET /recruitment/passes": "List recruitment passes",
      "POST /recruitment/passes": "Generate pass for candidate"
    },
    "compliance_endpoints": {
      "GET /compliance/alerts": "Get all compliance alerts",
      "GET /compliance/employee/{id}": "Get employee compliance status"
    },
    "document_endpoints": {
      "POST /documents/upload": "Upload document with optional OCR",
      "GET /documents/{id}": "Get document metadata",
      "GET /documents/employee/{id}": "List employee documents"
    }
  },

  "business_rules": {
    "numbering_conventions": {
      "employee_id": "Alphanumeric (e.g., ADMIN001, EMP001)",
      "candidate_number": "CAN-YYYYMMDD-XXXX",
      "recruitment_pass": "REC-YYYYMMDD-XXXX",
      "job_requisition": "REQ-YYYYMMDD-XXXX"
    },
    "employment_types": ["Full-time", "Part-time", "Contract", "Internship"],
    "approval_workflows": {
      "bank_details_change": "Employee submits → HR verifies → Applied",
      "contract_renewal": "HR initiates → Manager approves → HR finalizes"
    },
    "data_architecture": {
      "approach": "Metadata-first, document registry",
      "principle": "Employee Number anchors 5 linked tables",
      "tables_linked": ["employees", "employee_profiles", "employee_compliance", "employee_bank", "employee_documents"]
    }
  },

  "security_features": {
    "authentication": "JWT tokens with configurable expiry",
    "authorization": "Role-based access control (RBAC)",
    "input_validation": "Pydantic schemas with HTML escaping",
    "rate_limiting": "slowapi middleware",
    "cors": "Configurable CORS middleware"
  },

  "file_structure": {
    "backend": {
      "app/main.py": "FastAPI application entry point",
      "app/routers/": "API endpoint handlers",
      "app/services/": "Business logic layer",
      "app/repositories/": "Database access layer",
      "app/models/": "SQLAlchemy ORM models",
      "app/schemas/": "Pydantic request/response schemas",
      "app/core/": "Configuration and security utilities"
    },
    "frontend": {
      "src/App.tsx": "Main React application component",
      "src/services/api.ts": "API communication layer",
      "src/components/": "Reusable UI components",
      "src/styles/": "TailwindCSS configuration"
    },
    "database": {
      "alembic/": "Database migration scripts",
      "alembic.ini": "Alembic configuration"
    }
  },

  "current_data_state": {
    "employees": 76,
    "active_positions": 2,
    "candidates": 7,
    "positions_breakdown": [
      {"title": "Thermodynamics Engineer", "candidates": 6},
      {"title": "Electronics Engineer", "candidates": 1}
    ]
  }
}
