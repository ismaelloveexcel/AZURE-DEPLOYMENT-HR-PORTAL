import{r as l,j as e}from"./vendor-DgUtky3n.js";const L="/api",O=new Date().getFullYear();function ge({token:f,userId:R}){const[x,G]=l.useState("overview"),[o,B]=l.useState(null),[q,ee]=l.useState([]),[H,Y]=l.useState([]),[I,se]=l.useState(null),[k,ae]=l.useState(null),[v,N]=l.useState(!0),[w,c]=l.useState(!1),[J,g]=l.useState(null),[E,y]=l.useState(null),[n,S]=l.useState(null),[K,T]=l.useState(""),[h,X]=l.useState(""),[m,$]=l.useState(!1),[d,A]=l.useState({justification:"",achievements:"",impact_description:""});l.useEffect(()=>{F()},[]);const F=async()=>{N(!0),g(null);try{const[t,p,U]=await Promise.all([fetch(`${L}/nominations/admin/settings?year=${O}`,{headers:{Authorization:`Bearer ${f}`}}),fetch(`${L}/nominations/admin/manager-progress?year=${O}`,{headers:{Authorization:`Bearer ${f}`}}),fetch(`${L}/nominations/all?year=${O}`,{headers:{Authorization:`Bearer ${f}`}})]);if(t.ok){const M=await t.json();B(M)}if(p.ok){const M=await p.json();ee(M.managers||[])}if(U.ok){const M=await U.json();Y(M.nominations||[]),se(M.stats||null)}}catch{g("Failed to load data. Please try again.")}finally{N(!1)}},te=async()=>{if(o){c(!0),g(null);try{const t=await fetch(`${L}/nominations/admin/settings?year=${O}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({is_open:!o.is_open})});if(t.ok){const p=await t.json();B(p),y(p.is_open?"Nominations are now OPEN!":"Nominations are now CLOSED."),setTimeout(()=>y(null),3e3)}}catch{g("Failed to update settings.")}finally{c(!1)}}},Z=async t=>{c(!0);try{const p=await fetch(`${L}/nominations/admin/settings?year=${O}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({end_date:t?new Date(t).toISOString():null})});if(p.ok){const U=await p.json();B(U),y("Deadline updated!"),setTimeout(()=>y(null),3e3)}}catch{g("Failed to update deadline.")}finally{c(!1)}},z=async()=>{c(!0),g(null);try{const t=await fetch(`${L}/nominations/admin/send-invitations?year=${O}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({send_to_all:!0})});if(t.ok){const p=await t.json();y(p.message),setTimeout(()=>y(null),5e3),F()}else{const p=await t.json();g(p.detail||"Failed to send invitations.")}}catch{g("Failed to send invitations.")}finally{c(!1)}},P=async(t,p)=>{if(!R){g("Unable to review: User session not loaded. Please refresh and try again.");return}c(!0);try{(await fetch(`${L}/nominations/${t}/review?reviewer_id=${R}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({status:p,review_notes:K})})).ok&&(y(`Nomination ${p==="shortlisted"?"shortlisted":p==="winner"?"selected as WINNER":"updated"}!`),S(null),T(""),setTimeout(()=>y(null),3e3),F())}catch{g("Failed to update nomination.")}finally{c(!1)}},V=async()=>{if(!(!n||!R)){c(!0);try{const t=await fetch(`${L}/nominations/${n.id}/content?editor_id=${R}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({justification:d.justification||null,achievements:d.achievements||null,impact_description:d.impact_description||null})});if(t.ok)y("Nomination content updated!"),$(!1),S(null),setTimeout(()=>y(null),3e3),F();else{const p=await t.json();g(p.detail||"Failed to update nomination content.")}}catch{g("Failed to update nomination content.")}finally{c(!1)}}},a=async()=>{try{const t=await fetch(`${L}/nominations/admin/report?year=${O}`,{headers:{Authorization:`Bearer ${f}`}});if(t.ok){const p=await t.json();ae(p)}}catch{g("Failed to load report.")}},r=()=>{n&&(A({justification:n.justification,achievements:n.achievements||"",impact_description:n.impact_description||""}),$(!0))},b=q.filter(t=>t.name.toLowerCase().includes(h.toLowerCase())||t.email?.toLowerCase().includes(h.toLowerCase())||t.department?.toLowerCase().includes(h.toLowerCase())),u=H.filter(t=>t.nominee_name.toLowerCase().includes(h.toLowerCase())||t.nominator_name.toLowerCase().includes(h.toLowerCase())||t.nominee_department?.toLowerCase().includes(h.toLowerCase())),C="https://hr.baynunah.ae/nomination-pass",Q=q.filter(t=>t.has_nominated).length,D=q.length-Q;return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[J&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center justify-between",children:[e.jsx("span",{className:"text-red-700",children:J}),e.jsx("button",{onClick:()=>g(null),className:"text-red-500 hover:text-red-700",children:"√ó"})]}),E&&e.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4 flex items-center justify-between",children:[e.jsx("span",{className:"text-emerald-700",children:E}),e.jsx("button",{onClick:()=>y(null),className:"text-emerald-500 hover:text-emerald-700",children:"√ó"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-600 to-emerald-700 px-6 py-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-semibold text-white",children:["Employee of the Year ",O]}),e.jsx("p",{className:"text-emerald-100 text-sm",children:"Manage nominations and select the winner"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-medium ${o?.is_open?"bg-emerald-500 text-white":"bg-white/20 text-white"}`,children:o?.is_open?"OPEN":"CLOSED"}),e.jsx("button",{onClick:te,disabled:w,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o?.is_open?"bg-white/20 text-white hover:bg-white/30":"bg-white text-emerald-700 hover:bg-emerald-50"}`,children:o?.is_open?"Close Nominations":"Open Nominations"})]})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("div",{className:"flex",children:["overview","managers","nominations","report","settings"].map(t=>e.jsx("button",{onClick:()=>G(t),className:`flex-1 px-6 py-4 text-sm font-medium capitalize transition-colors ${x===t?"text-emerald-600 border-b-2 border-emerald-500 bg-emerald-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:t},t))})}),e.jsxs("div",{className:"p-6",children:[x==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Managers"}),e.jsx("p",{className:"text-3xl font-bold text-blue-700",children:q.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"Submitted"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-700",children:Q})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-amber-600 font-medium",children:"Pending"}),e.jsx("p",{className:"text-3xl font-bold text-amber-700",children:D})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-teal-600 font-medium",children:"Shortlisted"}),e.jsx("p",{className:"text-3xl font-bold text-teal-700",children:I?.shortlisted_count||0})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Nomination Link for Managers"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",value:C,readOnly:!0,className:"flex-1 px-4 py-3 bg-white border border-gray-200 rounded-lg text-sm text-gray-600"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(C),y("Link copied to clipboard!"),setTimeout(()=>y(null),2e3)},className:"px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm font-medium",children:"Copy Link"})]})]}),o?.end_date&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:e.jsxs("p",{className:"text-sm text-amber-700",children:[e.jsx("strong",{children:"Deadline:"})," ",new Date(o.end_date).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})]})}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{onClick:z,disabled:w||!o?.is_open,className:"flex-1 px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Sending...":"Send Email Invitations to Pending Managers"})})]}),x==="managers"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search managers...",value:h,onChange:t=>X(t.target.value),className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsxs("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full",children:[Q," submitted"]}),e.jsxs("span",{className:"px-3 py-1 bg-amber-100 text-amber-700 rounded-full",children:[D," pending"]})]})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Manager"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Nominee"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:b.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("p",{className:"font-medium text-gray-800",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.email})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.department||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.has_nominated?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"}`,children:t.has_nominated?"Submitted":"Pending"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.nominee_name||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:t.nominated_at?new Date(t.nominated_at).toLocaleDateString():"-"})]},t.id))})]})})]}),x==="nominations"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("input",{type:"text",placeholder:"Search nominations...",value:h,onChange:t=>X(t.target.value),className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"})}),e.jsxs("div",{className:"grid gap-4",children:[u.map(t=>e.jsxs("div",{className:`bg-white border rounded-xl p-5 cursor-pointer hover:shadow-md transition-shadow ${t.status==="winner"?"border-amber-300 bg-amber-50/50":t.status==="shortlisted"?"border-teal-200":"border-gray-200"}`,onClick:()=>S(t),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.status==="winner"&&e.jsx("svg",{className:"w-5 h-5 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),e.jsx("h3",{className:"font-semibold text-gray-800",children:t.nominee_name})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.nominee_job_title," ‚Ä¢ ",t.nominee_department]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Nominated by: ",t.nominator_name]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${t.status==="winner"?"bg-amber-100 text-amber-700":t.status==="shortlisted"?"bg-teal-100 text-teal-700":t.status==="not_selected"?"bg-slate-200 text-slate-900":"bg-blue-100 text-blue-700"}`,children:t.status==="pending"?"Pending Review":t.status.replace("_"," ").charAt(0).toUpperCase()+t.status.replace("_"," ").slice(1)})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-3 line-clamp-2",children:t.justification})]},t.id)),u.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No nominations yet."})]})]}),x==="report"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Management Selection Report"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Comprehensive overview for final selection decision"})]}),e.jsx("button",{onClick:a,disabled:w,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors font-medium disabled:opacity-50",children:k?"Refresh Report":"Generate Report"})]}),k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:k.total_nominations}),e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Total Nominations"})]}),e.jsxs("div",{className:"bg-teal-50 border border-teal-200 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-teal-700",children:k.shortlisted_count}),e.jsx("p",{className:"text-xs text-teal-600 uppercase tracking-wider",children:"Shortlisted"})]}),e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-amber-700",children:k.entries.filter(t=>t.status==="winner").length}),e.jsx("p",{className:"text-xs text-amber-600 uppercase tracking-wider",children:"Winners"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-700",children:k.year}),e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Year"})]})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Rank"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Nominee"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Years"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Nominated By"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:k.entries.map(t=>e.jsxs("tr",{className:`hover:bg-gray-50 ${t.status==="winner"?"bg-amber-50":t.status==="shortlisted"?"bg-teal-50/30":""}`,children:[e.jsxs("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:["#",t.rank]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.nominee_name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.nominee_job_title})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.nominee_department||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.years_of_service??"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.nominator_name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="winner"?"bg-amber-100 text-amber-700":t.status==="shortlisted"?"bg-teal-100 text-teal-700":t.status==="not_selected"?"bg-slate-200 text-slate-900":"bg-blue-100 text-blue-700"}`,children:t.status==="pending"?"Pending":t.status.replace("_"," ")})})]},t.id))})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800",children:"Detailed Justifications"}),k.entries.filter(t=>t.status==="shortlisted"||t.status==="winner").map(t=>e.jsxs("div",{className:`bg-white border rounded-xl p-5 ${t.status==="winner"?"border-amber-300":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.status==="winner"&&e.jsx("svg",{className:"w-5 h-5 text-amber-500",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),e.jsx("span",{className:"font-semibold text-gray-800",children:t.nominee_name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["‚Ä¢ ",t.nominee_job_title]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="winner"?"bg-amber-100 text-amber-700":"bg-teal-100 text-teal-700"}`,children:t.status==="winner"?"Winner":"Shortlisted"})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-1",children:"Justification"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.justification})]}),t.achievements&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-1",children:"Achievements"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.achievements})]}),t.impact_description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-1",children:"Impact"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.impact_description})]}),t.review_notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-1",children:"HR Notes"}),e.jsx("p",{className:"text-gray-600 italic",children:t.review_notes})]})]})]},t.id))]}),e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["Report generated on ",new Date(k.generated_at).toLocaleString()]})]}),!k&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:'Click "Generate Report" to create the management selection report.'})]}),x==="settings"&&o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nomination Deadline"}),e.jsx("input",{type:"date",value:o.end_date?new Date(o.end_date).toISOString().split("T")[0]:"",onChange:t=>Z(t.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emails Sent"}),e.jsxs("div",{className:"px-4 py-3 bg-gray-100 rounded-lg text-gray-600",children:[o.emails_sent_count," emails sent",o.last_email_sent_at&&e.jsxs("span",{className:"text-sm text-gray-400 ml-2",children:["(last: ",new Date(o.last_email_sent_at).toLocaleDateString(),")"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Subject"}),e.jsx("input",{type:"text",value:o.invitation_email_subject||"",onChange:async t=>{const p=t.target.value;B({...o,invitation_email_subject:p})},onBlur:async t=>{await fetch(`${L}/nominations/admin/settings?year=${O}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({invitation_email_subject:t.target.value})})},className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Body"}),e.jsx("textarea",{value:o.invitation_email_body||"",onChange:t=>B({...o,invitation_email_body:t.target.value}),onBlur:async t=>{await fetch(`${L}/nominations/admin/settings?year=${O}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({invitation_email_body:t.target.value})})},rows:10,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 font-mono text-sm"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'This is the email that will be sent to managers when you click "Send Invitations"'})]})]})]})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:n.nominee_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[n.nominee_job_title," ‚Ä¢ ",n.nominee_department]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!m&&e.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:"Edit"}),e.jsx("button",{onClick:()=>{S(null),$(!1)},className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-1",children:"Nominated By"}),e.jsx("p",{className:"text-gray-800",children:n.nominator_name})]}),m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-2",children:"Why They Deserve the Award"}),e.jsx("textarea",{value:d.justification,onChange:t=>A({...d,justification:t.target.value}),rows:4,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Minimum 50 characters required"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-2",children:"Key Achievements"}),e.jsx("textarea",{value:d.achievements,onChange:t=>A({...d,achievements:t.target.value}),rows:3,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-2",children:"Impact on Team/Organization"}),e.jsx("textarea",{value:d.impact_description,onChange:t=>A({...d,impact_description:t.target.value}),rows:3,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:V,disabled:w||d.justification.length<50,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50",children:w?"Saving...":"Save Changes"}),e.jsx("button",{onClick:()=>$(!1),className:"px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-1",children:"Why They Deserve the Award"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:n.justification})]}),n.achievements&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-1",children:"Key Achievements"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:n.achievements})]}),n.impact_description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-1",children:"Impact on Team/Organization"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:n.impact_description})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider mb-2",children:"Review Notes (Optional)"}),e.jsx("textarea",{value:K,onChange:t=>T(t.target.value),placeholder:"Add notes about this nomination...",rows:3,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[n.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>P(n.id,"shortlisted"),disabled:w,className:"flex-1 px-4 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors font-medium disabled:opacity-50",children:"Shortlist"}),e.jsx("button",{onClick:()=>P(n.id,"not_selected"),disabled:w,className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium disabled:opacity-50",children:"Not Selected"})]}),n.status==="shortlisted"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>P(n.id,"winner"),disabled:w,className:"flex-1 px-4 py-3 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition-colors font-medium disabled:opacity-50",children:"Select as Winner"}),e.jsx("button",{onClick:()=>P(n.id,"not_selected"),disabled:w,className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium disabled:opacity-50",children:"Not Selected"})]}),n.status==="winner"&&e.jsxs("div",{className:"flex-1 px-4 py-3 bg-amber-100 text-amber-700 rounded-lg text-center font-medium",children:["This employee is the ",O," Winner"]})]})]})]})]})})]})}const ne="/api",ce=["full_name","dob","gender","relation","staff_id","category","effective_date","nationality","uid_number"],me=["emirates_id_number","gdrfa_file_number","passport_number"],xe=[...ce,...me],de=[{key:"sr_no",label:"SR No",width:"60px"},{key:"full_name",label:"Full Name",width:"180px"},{key:"staff_id",label:"Staff ID",width:"90px"},{key:"relation",label:"Relation",width:"90px"},{key:"dob",label:"DOB",width:"100px"},{key:"gender",label:"Gender",width:"70px"},{key:"nationality",label:"Nationality",width:"110px"},{key:"category",label:"Category",width:"100px"},{key:"emirates_id_number",label:"Emirates ID",width:"160px"},{key:"uid_number",label:"UID",width:"140px"},{key:"gdrfa_file_number",label:"GDRFA",width:"120px"},{key:"passport_number",label:"Passport",width:"120px"},{key:"effective_date",label:"Effective Date",width:"110px"},{key:"mobile_no",label:"Mobile",width:"120px"},{key:"completeness_pct",label:"Complete %",width:"90px"}];function be({token:f,onBack:R}){const[x,G]=l.useState([]),[o,B]=l.useState(null),[q,ee]=l.useState(!0),[H,Y]=l.useState(null),[I,se]=l.useState("all"),[k,ae]=l.useState("all"),[v,N]=l.useState(""),[w,c]=l.useState(null),[J,g]=l.useState(""),[E,y]=l.useState({}),[n,S]=l.useState(!1),[K,T]=l.useState(null),h=l.useCallback(async()=>{ee(!0),Y(null);try{const a=new URLSearchParams;I!=="all"&&a.append("entity",I),k!=="all"&&a.append("insurance_type",k),v&&a.append("search",v);const[r,b]=await Promise.all([fetch(`${ne}/insurance-census?${a}`,{headers:{Authorization:`Bearer ${f}`}}),fetch(`${ne}/insurance-census/summary`,{headers:{Authorization:`Bearer ${f}`}})]);if(!r.ok)throw new Error("Failed to fetch records");if(!b.ok)throw new Error("Failed to fetch summary");const u=await r.json(),C=await b.json();G(u.records||u),B(C)}catch(a){Y(a instanceof Error?a.message:"Failed to load data")}finally{ee(!1)}},[f,I,k,v]);l.useEffect(()=>{h()},[h]);const X=(a,r,b)=>{if(r==="completeness_pct")return;c({id:a,field:r});const u=E[a]?.[r];g(u??b??"")},m=a=>{g(a)},$=()=>{if(w){const{id:a,field:r}=w,b=x.find(C=>C.id===a),u=b?b[r]??"":"";J!==u&&y(C=>({...C,[a]:{...C[a],[r]:J}}))}c(null),g("")},d=a=>{a.key==="Enter"?$():a.key==="Escape"&&(c(null),g(""))},A=Object.keys(E).length>0,F=async()=>{if(A){S(!0),T(null),Y(null);try{const a=Object.entries(E).map(([u,C])=>({id:parseInt(u),...C})),r=await fetch(`${ne}/insurance-census/batch-update`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({updates:a})});if(!r.ok){const u=await r.json();throw new Error(u.detail||"Failed to save changes")}const b=await r.json();T(`Saved ${b.updated} records successfully`),y({}),await h(),setTimeout(()=>T(null),3e3)}catch(a){Y(a instanceof Error?a.message:"Failed to save changes")}finally{S(!1)}}},te=()=>{y({})},Z=(a,r)=>{const b=E[a.id]?.[r];if(b!==void 0)return b;const u=a[r];return u==null?"":typeof u=="number"?u.toString():u},z=a=>xe.includes(a),P=(a,r)=>{if(!z(r))return!1;const b=Z(a,r);return!b||b.trim()===""},V=a=>a==="watergeneration"?"#00B0F0":"#00bf63";return q&&x.length===0?e.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:e.jsx("div",{className:"text-white",children:"Loading census data..."})}):e.jsx("div",{className:"min-h-screen bg-slate-950 text-white",children:e.jsxs("div",{className:"max-w-full mx-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:R,className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm font-medium transition-colors",children:"‚Üê Back"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Medical Insurance Census"})]}),e.jsx("div",{className:"flex items-center gap-3",children:A&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-amber-400 text-sm",children:[Object.keys(E).length," records modified"]}),e.jsx("button",{onClick:te,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm font-medium transition-colors",children:"Discard"}),e.jsx("button",{onClick:F,disabled:n,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:n?"Saving...":"Save Changes"})]})})]}),K&&e.jsx("div",{className:"mb-4 p-3 bg-emerald-900/50 border border-emerald-500 rounded-lg text-emerald-400",children:K}),H&&e.jsx("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-500 rounded-lg text-red-400",children:H}),o&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold",children:o.total}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Total Records"})]}),e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-400",children:o.linked}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Linked to Employees"})]}),e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold",style:{color:"#00B0F0"},children:o.by_entity?.watergeneration||0}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Watergeneration"})]}),e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold",style:{color:"#00bf63"},children:o.by_entity?.agriculture||0}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Agriculture"})]}),e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4",children:[e.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(o.avg_completeness),"%"]}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Avg Completeness"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-slate-400",children:"Entity:"}),e.jsxs("select",{value:I,onChange:a=>se(a.target.value),className:"bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"All Entities"}),e.jsx("option",{value:"watergeneration",children:"Watergeneration"}),e.jsx("option",{value:"agriculture",children:"Agriculture"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-slate-400",children:"Type:"}),e.jsxs("select",{value:k,onChange:a=>ae(a.target.value),className:"bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"thiqa",children:"Thiqa"}),e.jsx("option",{value:"expats",children:"Expats"})]})]}),e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx("input",{type:"text",placeholder:"Search by name, staff ID, Emirates ID...",value:v,onChange:a=>N(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-sm placeholder-slate-500"})}),e.jsxs("div",{className:"text-sm text-slate-400",children:["Showing ",x.length," records"]})]}),e.jsx("div",{className:"bg-slate-900 rounded-xl border border-slate-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-800 border-b border-slate-700",children:[e.jsx("th",{className:"sticky left-0 bg-slate-800 px-2 py-3 text-left font-medium text-slate-300 z-10",style:{width:"100px"},children:"Entity / Type"}),de.map(a=>e.jsxs("th",{className:`px-2 py-3 text-left font-medium ${z(a.key)?"text-amber-400":"text-slate-300"}`,style:{minWidth:a.width},children:[a.label,z(a.key)&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]},a.key))]})}),e.jsx("tbody",{children:x.map(a=>e.jsxs("tr",{className:"border-b border-slate-800 hover:bg-slate-800/50",children:[e.jsx("td",{className:"sticky left-0 bg-slate-900 px-2 py-2 z-10",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium text-white",style:{backgroundColor:V(a.entity)},children:a.entity==="watergeneration"?"Water":"Agri"}),e.jsx("span",{className:"text-xs text-slate-400 capitalize",children:a.insurance_type})]})}),de.map(r=>{const b=w?.id===a.id&&w?.field===r.key,u=Z(a,r.key),C=P(a,r.key),Q=E[a.id]?.[r.key]!==void 0;if(r.key==="completeness_pct"){const D=a.completeness_pct;return e.jsx("td",{className:"px-2 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${D>=80?"bg-emerald-500":D>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${D}%`}})}),e.jsxs("span",{className:"text-xs",children:[D,"%"]})]})},r.key)}return e.jsx("td",{className:`px-2 py-2 cursor-pointer ${C?"bg-red-900/30":""} ${Q?"bg-amber-900/30":""}`,onClick:()=>X(a.id,r.key,a[r.key]),children:b?e.jsx("input",{type:"text",value:J,onChange:D=>m(D.target.value),onBlur:$,onKeyDown:d,autoFocus:!0,className:"w-full bg-slate-700 border border-blue-500 rounded px-2 py-1 text-sm focus:outline-none"}):e.jsx("span",{className:`${u?"":"text-slate-500 italic"}`,children:u||(C?"Required":"-")})},r.key)})]},a.id))})]})})}),e.jsx("div",{className:"mt-4 text-sm text-slate-400",children:e.jsxs("p",{children:[e.jsx("span",{className:"text-red-400",children:"*"})," = Mandatory field | ",e.jsx("span",{className:"bg-red-900/30 px-2 py-0.5 rounded",children:"Red cells"})," = Missing required data | ",e.jsx("span",{className:"bg-amber-900/30 px-2 py-0.5 rounded",children:"Amber cells"})," = Pending changes"]})})]})})}const W="/api",he={5:"Outstanding",4:"Exceeds Expectations",3:"Meets Expectations",2:"Developing",1:"Needs Improvement"},ue=["Annual","Mid-Year","Quarterly","Probation"],re={draft:"bg-slate-100 text-slate-600",active:"bg-emerald-100 text-emerald-700",completed:"bg-blue-100 text-blue-700",pending:"bg-amber-100 text-amber-700",in_progress:"bg-blue-100 text-blue-700",closed:"bg-slate-200 text-slate-600"};function fe({user:f,fetchWithAuth:R}){const[x,G]=l.useState("cycles"),[o,B]=l.useState([]),[q,ee]=l.useState([]),[H,Y]=l.useState([]),[I,se]=l.useState([]),[k,ae]=l.useState(null),[v,N]=l.useState(!1),[w,c]=l.useState(null),[J,g]=l.useState(!1),[E,y]=l.useState(null),[n,S]=l.useState({name:"",cycle_type:"Annual",start_date:"",end_date:"",self_assessment_deadline:"",manager_review_deadline:""}),[K,T]=l.useState(!1),[h,X]=l.useState(null),[m,$]=l.useState({achievements:"",challenges:"",goals_next_period:"",training_needs:"",overall_comments:"",ratings:{}}),[d,A]=l.useState({achievements:"",areas_improvement:"",recommendations:"",overall_comments:"",ratings:{}}),[F,te]=l.useState(null),[Z,z]=l.useState(!1),[P,V]=l.useState(""),a=f.role==="admin"||f.role==="hr";l.useEffect(()=>{x==="cycles"?r():x==="my-reviews"?b():x==="team-reviews"&&u()},[x]);const r=async()=>{N(!0),c(null);try{const s=await R(`${W}/performance/cycles`);if(!s.ok)throw new Error("Failed to fetch cycles");const i=await s.json();B(i)}catch(s){c(s instanceof Error?s.message:"Failed to fetch cycles")}finally{N(!1)}},b=async()=>{N(!0),c(null);try{const s=await R(`${W}/performance/my-reviews`);if(!s.ok)throw new Error("Failed to fetch reviews");const i=await s.json();Y(i)}catch(s){c(s instanceof Error?s.message:"Failed to fetch reviews")}finally{N(!1)}},u=async()=>{N(!0),c(null);try{const s=await R(`${W}/performance/team-reviews`);if(!s.ok)throw new Error("Failed to fetch team reviews");const i=await s.json();se(i)}catch(s){c(s instanceof Error?s.message:"Failed to fetch team reviews")}finally{N(!1)}},C=s=>{s?(y(s),S({name:s.name,cycle_type:s.cycle_type,start_date:s.start_date,end_date:s.end_date,self_assessment_deadline:s.self_assessment_deadline||"",manager_review_deadline:s.manager_review_deadline||""})):(y(null),S({name:"",cycle_type:"Annual",start_date:"",end_date:"",self_assessment_deadline:"",manager_review_deadline:""})),g(!0)},Q=async s=>{s.preventDefault(),N(!0),c(null);try{const i={...n,self_assessment_deadline:n.self_assessment_deadline||null,manager_review_deadline:n.manager_review_deadline||null},_=E?`${W}/performance/cycles/${E.id}`:`${W}/performance/cycles`,ie=await R(_,{method:E?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!ie.ok){const oe=await ie.json();throw new Error(oe.detail||"Failed to save cycle")}g(!1),r()}catch(i){c(i instanceof Error?i.message:"Failed to save cycle")}finally{N(!1)}},D=async s=>{X(s);const i={};s.ratings.forEach(j=>{i[j.competency_name]={rating:j.self_rating||3,comments:j.self_comments||""}}),$({achievements:"",challenges:"",goals_next_period:"",training_needs:"",overall_comments:"",ratings:i});const _={};s.ratings.forEach(j=>{_[j.competency_name]={rating:j.manager_rating||3,comments:j.manager_comments||""}}),A({achievements:"",areas_improvement:"",recommendations:"",overall_comments:"",ratings:_}),T(!0)},t=async()=>{if(h){N(!0),c(null);try{const s={self_achievements:m.achievements,self_challenges:m.challenges,self_goals_next_period:m.goals_next_period,self_training_needs:m.training_needs,self_overall_comments:m.overall_comments,ratings:Object.entries(m.ratings).map(([_,j])=>({competency_name:_,self_rating:j.rating,self_comments:j.comments}))},i=await R(`${W}/performance/reviews/${h.id}/self-assessment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const _=await i.json();throw new Error(_.detail||"Failed to submit assessment")}T(!1),b()}catch(s){c(s instanceof Error?s.message:"Failed to submit assessment")}finally{N(!1)}}},p=async()=>{if(h){N(!0),c(null);try{const s={manager_achievements:d.achievements,manager_areas_improvement:d.areas_improvement,manager_recommendations:d.recommendations,manager_overall_comments:d.overall_comments,ratings:Object.entries(d.ratings).map(([_,j])=>({competency_name:_,manager_rating:j.rating,manager_comments:j.comments}))},i=await R(`${W}/performance/reviews/${h.id}/manager-review`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const _=await i.json();throw new Error(_.detail||"Failed to submit review")}T(!1),u()}catch(s){c(s instanceof Error?s.message:"Failed to submit review")}finally{N(!1)}}},U=async()=>{if(F){N(!0),c(null);try{const s=P.split(",").map(j=>parseInt(j.trim())).filter(j=>!isNaN(j)),i=await R(`${W}/performance/reviews/bulk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cycle_id:F.id,employee_ids:s})});if(!i.ok){const j=await i.json();throw new Error(j.detail||"Failed to create reviews")}const _=await i.json();z(!1),V(""),alert(`Created ${_.created} reviews`),r()}catch(s){c(s instanceof Error?s.message:"Failed to create reviews")}finally{N(!1)}}},M=s=>new Date(s).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),le=(s,i)=>e.jsxs("div",{className:"flex gap-1",children:[[1,2,3,4,5].map(_=>e.jsx("button",{type:"button",onClick:()=>i?.(_),disabled:!i,className:`text-xl transition-colors ${_<=s?"text-amber-400":"text-slate-300"} ${i?"hover:text-amber-500 cursor-pointer":"cursor-default"}`,children:"‚òÖ"},_)),e.jsx("span",{className:"ml-2 text-sm text-slate-500",children:he[s]||""})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl shadow-lg shadow-slate-200/50 border border-white/60 p-8 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-800",children:"Growth & Appraisals"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage review cycles, self-assessments, and team evaluations"})]}),a&&e.jsxs("button",{onClick:()=>C(),className:"px-5 py-2.5 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors font-medium flex items-center gap-2 shadow-sm",children:[e.jsx("span",{className:"text-lg",children:"+"}),"New Cycle"]})]}),e.jsxs("div",{className:"flex gap-2 border-b border-slate-200",children:[e.jsxs("button",{onClick:()=>G("cycles"),className:`px-4 py-3 font-medium transition-colors relative ${x==="cycles"?"text-emerald-600":"text-slate-500 hover:text-slate-700"}`,children:["Review Cycles",x==="cycles"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-500 rounded-full"})]}),e.jsxs("button",{onClick:()=>G("my-reviews"),className:`px-4 py-3 font-medium transition-colors relative ${x==="my-reviews"?"text-emerald-600":"text-slate-500 hover:text-slate-700"}`,children:["My Reviews",x==="my-reviews"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-500 rounded-full"})]}),e.jsxs("button",{onClick:()=>G("team-reviews"),className:`px-4 py-3 font-medium transition-colors relative ${x==="team-reviews"?"text-emerald-600":"text-slate-500 hover:text-slate-700"}`,children:["Team Reviews",x==="team-reviews"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-500 rounded-full"})]})]})]}),w&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:w}),v&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-3 border-emerald-500 border-t-transparent rounded-full animate-spin"})}),!v&&x==="cycles"&&e.jsx("div",{className:"grid gap-4",children:o.length===0?e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl shadow-lg shadow-slate-200/50 border border-white/60 p-12 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üìã"}),e.jsx("h3",{className:"text-lg font-medium text-slate-700 mb-2",children:"No Review Cycles"}),e.jsx("p",{className:"text-slate-500",children:"Create a new performance review cycle to get started."})]}):o.map(s=>e.jsx("div",{className:"bg-white/80 backdrop-blur-md rounded-2xl shadow-md shadow-slate-200/50 border border-white/60 p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:s.name}),e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${re[s.status]||"bg-slate-100 text-slate-600"}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),e.jsx("span",{className:"px-2.5 py-1 bg-slate-100 rounded-full text-xs font-medium text-slate-600",children:s.cycle_type})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"üìÖ"}),e.jsxs("span",{children:[M(s.start_date)," - ",M(s.end_date)]})]}),s.self_assessment_deadline&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"‚úçÔ∏è"}),e.jsxs("span",{children:["Self-assessment by ",M(s.self_assessment_deadline)]})]}),s.manager_review_deadline&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"üëî"}),e.jsxs("span",{children:["Manager review by ",M(s.manager_review_deadline)]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"üë•"}),e.jsxs("span",{children:[s.review_count," reviews"]})]})]})]}),a&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{te(s),z(!0)},className:"px-3 py-2 text-sm bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:"Add Reviews"}),e.jsx("button",{onClick:()=>C(s),className:"px-3 py-2 text-sm bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition-colors",children:"Edit"})]})]})},s.id))}),!v&&x==="my-reviews"&&e.jsx("div",{className:"grid gap-4",children:H.length===0?e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl shadow-lg shadow-slate-200/50 border border-white/60 p-12 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üìù"}),e.jsx("h3",{className:"text-lg font-medium text-slate-700 mb-2",children:"No Reviews Assigned"}),e.jsx("p",{className:"text-slate-500",children:"You don't have any performance reviews to complete at this time."})]}):H.map(s=>e.jsx("div",{className:"bg-white/80 backdrop-blur-md rounded-2xl shadow-md shadow-slate-200/50 border border-white/60 p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:s.cycle_name}),e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${re[s.status]||"bg-slate-100 text-slate-600"}`,children:s.status.replace("_"," ").charAt(0).toUpperCase()+s.status.replace("_"," ").slice(1)})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-500",children:[s.reviewer_name&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"üëî"}),e.jsxs("span",{children:["Reviewer: ",s.reviewer_name]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"‚úçÔ∏è"}),e.jsxs("span",{children:["Self-assessment: ",s.self_assessment_submitted?"‚úÖ Submitted":"‚è≥ Pending"]})]}),s.overall_rating&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"‚≠ê"}),e.jsxs("span",{children:["Rating: ",s.overall_rating.toFixed(1)," - ",s.rating_label]})]})]})]}),!s.self_assessment_submitted&&e.jsx("button",{onClick:()=>D(s),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors font-medium",children:"Complete Self-Assessment"})]})},s.id))}),!v&&x==="team-reviews"&&e.jsx("div",{className:"grid gap-4",children:I.length===0?e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl shadow-lg shadow-slate-200/50 border border-white/60 p-12 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üë•"}),e.jsx("h3",{className:"text-lg font-medium text-slate-700 mb-2",children:"No Team Reviews"}),e.jsx("p",{className:"text-slate-500",children:"You don't have any team member reviews to complete."})]}):I.map(s=>e.jsx("div",{className:"bg-white/80 backdrop-blur-md rounded-2xl shadow-md shadow-slate-200/50 border border-white/60 p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:s.employee_name}),e.jsx("span",{className:"text-slate-400",children:"‚Ä¢"}),e.jsx("span",{className:"text-slate-600",children:s.cycle_name}),e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${re[s.status]||"bg-slate-100 text-slate-600"}`,children:s.status.replace("_"," ").charAt(0).toUpperCase()+s.status.replace("_"," ").slice(1)})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"‚úçÔ∏è"}),e.jsxs("span",{children:["Self-assessment: ",s.self_assessment_submitted?"‚úÖ Submitted":"‚è≥ Pending"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"üëî"}),e.jsxs("span",{children:["Manager review: ",s.manager_review_submitted?"‚úÖ Completed":"‚è≥ Pending"]})]}),s.overall_rating&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"‚≠ê"}),e.jsxs("span",{children:["Rating: ",s.overall_rating.toFixed(1)," - ",s.rating_label]})]})]})]}),s.self_assessment_submitted&&!s.manager_review_submitted&&e.jsx("button",{onClick:()=>D(s),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium",children:"Complete Manager Review"})]})},s.id))})]}),J&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl max-w-lg w-full p-8 border border-white/60",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:E?"Edit Review Cycle":"Create Review Cycle"}),e.jsxs("form",{onSubmit:Q,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Cycle Name"}),e.jsx("input",{type:"text",value:n.name,onChange:s=>S({...n,name:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",placeholder:"e.g., 2026 Annual Review",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Cycle Type"}),e.jsx("select",{value:n.cycle_type,onChange:s=>S({...n,cycle_type:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",children:ue.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Start Date"}),e.jsx("input",{type:"date",value:n.start_date,onChange:s=>S({...n,start_date:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"End Date"}),e.jsx("input",{type:"date",value:n.end_date,onChange:s=>S({...n,end_date:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Self-Assessment Deadline"}),e.jsx("input",{type:"date",value:n.self_assessment_deadline,onChange:s=>S({...n,self_assessment_deadline:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Manager Review Deadline"}),e.jsx("input",{type:"date",value:n.manager_review_deadline,onChange:s=>S({...n,manager_review_deadline:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>g(!1),className:"flex-1 px-4 py-3 bg-slate-100 text-slate-600 rounded-xl hover:bg-slate-200 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"flex-1 px-4 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors font-medium disabled:opacity-50",children:v?"Saving...":E?"Update Cycle":"Create Cycle"})]})]})]})}),Z&&F&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl max-w-lg w-full p-8 border border-white/60",children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-800 mb-2",children:["Add Reviews to ",F.name]}),e.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Enter employee IDs (comma-separated) to create reviews"}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Employee IDs"}),e.jsx("textarea",{value:P,onChange:s=>V(s.target.value),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",placeholder:"e.g., 1, 2, 3, 4, 5",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{z(!1),V("")},className:"flex-1 px-4 py-3 bg-slate-100 text-slate-600 rounded-xl hover:bg-slate-200 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"button",onClick:U,disabled:v||!P.trim(),className:"flex-1 px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors font-medium disabled:opacity-50",children:v?"Creating...":"Create Reviews"})]})]})]})}),K&&h&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl max-w-2xl w-full p-8 border border-white/60 my-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-2",children:h.employee_name!==f.name?`Review for ${h.employee_name}`:"Self-Assessment"}),e.jsx("p",{className:"text-slate-500 text-sm mb-6",children:h.cycle_name}),h.employee_name===f.name&&!h.self_assessment_submitted?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Competency Ratings"}),e.jsx("div",{className:"space-y-4",children:h.ratings.map(s=>e.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-slate-700",children:s.competency_name}),e.jsxs("span",{className:"text-xs text-slate-400",children:[s.weight,"%"]})]}),le(m.ratings[s.competency_name]?.rating||3,i=>$({...m,ratings:{...m.ratings,[s.competency_name]:{...m.ratings[s.competency_name],rating:i}}})),e.jsx("textarea",{value:m.ratings[s.competency_name]?.comments||"",onChange:i=>$({...m,ratings:{...m.ratings,[s.competency_name]:{...m.ratings[s.competency_name],comments:i.target.value}}}),className:"w-full mt-2 px-3 py-2 text-sm bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none",placeholder:"Add comments...",rows:2})]},s.competency_name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Key Achievements"}),e.jsx("textarea",{value:m.achievements,onChange:s=>$({...m,achievements:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",placeholder:"Describe your key achievements during this period...",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Challenges Faced"}),e.jsx("textarea",{value:m.challenges,onChange:s=>$({...m,challenges:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",placeholder:"What challenges did you face?",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Goals for Next Period"}),e.jsx("textarea",{value:m.goals_next_period,onChange:s=>$({...m,goals_next_period:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",placeholder:"What are your goals for the next period?",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Training & Development Needs"}),e.jsx("textarea",{value:m.training_needs,onChange:s=>$({...m,training_needs:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-400 outline-none transition-all",placeholder:"What training or development would help you?",rows:2})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>T(!1),className:"flex-1 px-4 py-3 bg-slate-100 text-slate-600 rounded-xl hover:bg-slate-200 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"button",onClick:t,disabled:v,className:"flex-1 px-4 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors font-medium disabled:opacity-50",children:v?"Submitting...":"Submit Self-Assessment"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Competency Ratings"}),e.jsx("div",{className:"space-y-4",children:h.ratings.map(s=>e.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-slate-700",children:s.competency_name}),e.jsxs("span",{className:"text-xs text-slate-400",children:[s.weight,"%"]})]}),s.self_rating&&e.jsxs("div",{className:"mb-2 text-sm text-slate-500",children:["Employee self-rating: ",le(s.self_rating),s.self_comments&&e.jsx("p",{className:"mt-1 italic",children:s.self_comments})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Your rating:"}),le(d.ratings[s.competency_name]?.rating||3,i=>A({...d,ratings:{...d.ratings,[s.competency_name]:{...d.ratings[s.competency_name],rating:i}}}))]}),e.jsx("textarea",{value:d.ratings[s.competency_name]?.comments||"",onChange:i=>A({...d,ratings:{...d.ratings,[s.competency_name]:{...d.ratings[s.competency_name],comments:i.target.value}}}),className:"w-full mt-2 px-3 py-2 text-sm bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 outline-none",placeholder:"Add your comments...",rows:2})]},s.competency_name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Key Achievements Observed"}),e.jsx("textarea",{value:d.achievements,onChange:s=>A({...d,achievements:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 outline-none transition-all",placeholder:"What achievements did you observe?",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Areas for Improvement"}),e.jsx("textarea",{value:d.areas_improvement,onChange:s=>A({...d,areas_improvement:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 outline-none transition-all",placeholder:"What areas need improvement?",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1.5",children:"Recommendations"}),e.jsx("textarea",{value:d.recommendations,onChange:s=>A({...d,recommendations:s.target.value}),className:"w-full px-4 py-3 bg-white/80 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 outline-none transition-all",placeholder:"Training, development, or other recommendations...",rows:3})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>T(!1),className:"flex-1 px-4 py-3 bg-slate-100 text-slate-600 rounded-xl hover:bg-slate-200 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"button",onClick:p,disabled:v,className:"flex-1 px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors font-medium disabled:opacity-50",children:v?"Submitting...":"Complete Review"})]})]})]})})]})}export{ge as E,be as I,fe as P};
